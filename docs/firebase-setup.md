# Firebase Setup Guide

This guide explains how to set up Firebase Realtime Database for global high score persistence in Space Scroller.

## Prerequisites

- A Google account
- A web browser

## Step 1: Create a Firebase Project

1. Go to the [Firebase Console](https://console.firebase.google.com/)
2. Click **Add project**
3. Enter a project name (e.g., "space-scroller-highscores")
4. Optionally disable Google Analytics (not needed for this feature)
5. Click **Create project**
6. Wait for the project to be created, then click **Continue**

## Step 2: Enable Realtime Database

1. In the Firebase Console, select your project
2. In the left sidebar, click **Build** > **Realtime Database**
3. Click **Create Database**
4. Choose a database location (select the region closest to your players)
5. Select **Start in test mode** (we will configure security rules next)
6. Click **Enable**

## Step 3: Configure Security Rules

After creating the database, configure the security rules to allow public read/write access to the `/scores` path only.

1. In the Realtime Database section, click the **Rules** tab
2. Replace the default rules with the following:

```json
{
  "rules": {
    "scores": {
      ".read": true,
      ".write": true,
      ".indexOn": ["score"]
    }
  }
}
```

3. Click **Publish**

**Note:** These rules allow anyone to read and write scores. For a production game, you may want to add additional validation or rate limiting. The `.indexOn` rule enables efficient sorting by score.

## Step 4: Get Your Database URL

1. In the Realtime Database section, look at the top of the page
2. You will see your database URL in the format:
   ```
   https://your-project-id-default-rtdb.firebaseio.com/
   ```
3. Copy this URL (you will need it for the configuration file)

## Step 5: Configure the Game

1. Open the file `config/firebase_config.json` in your project
2. Replace the placeholder values with your Firebase project details:

```json
{
    "project_id": "your-firebase-project-id",
    "database_url": "https://your-firebase-project-id-default-rtdb.firebaseio.com"
}
```

**Example with real values:**

```json
{
    "project_id": "space-scroller-highscores",
    "database_url": "https://space-scroller-highscores-default-rtdb.firebaseio.com"
}
```

3. Save the file

## Database Structure

The game stores scores in the following structure:

```
/scores
    /<auto-generated-key>
        score: <integer>
        initials: <string, 3 characters>
        timestamp: <unix timestamp>
```

**Example:**

```json
{
  "scores": {
    "-NxYz123abc": {
      "score": 15000,
      "initials": "AAA",
      "timestamp": 1736550000
    },
    "-NxYz456def": {
      "score": 12500,
      "initials": "BOB",
      "timestamp": 1736551000
    }
  }
}
```

Each score entry contains:

| Field | Type | Description |
|-------|------|-------------|
| `score` | integer | The player's score |
| `initials` | string | 3-character player initials (e.g., "AAA") |
| `timestamp` | integer | Unix timestamp when the score was submitted |

## Verification

To verify your setup is working:

1. Run the game and achieve a high score
2. Check the Firebase Console > Realtime Database > Data tab
3. You should see a new entry under `/scores` with your score

## Troubleshooting

**Scores not appearing in Firebase:**

- Verify your `firebase_config.json` has the correct database URL
- Check that the URL does not have a trailing slash
- Ensure your security rules allow writes to `/scores`
- Check your internet connection

**Error in console:**

- The game handles Firebase errors silently to avoid interrupting gameplay
- If scores are not being saved, check the database URL format

**Security rules error:**

- Make sure the rules are valid JSON
- Verify the `.indexOn` is set to `["score"]` (with quotes around "score")

## Security Considerations

The current setup uses public read/write access. For a production game, consider:

- Adding server-side validation to prevent impossible scores
- Implementing rate limiting to prevent spam
- Using Firebase Authentication for user identification
- Adding anti-cheat measures

For this game's scope, public access is acceptable since high scores are for entertainment only.
